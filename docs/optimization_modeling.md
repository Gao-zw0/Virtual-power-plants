# è™šæ‹Ÿç”µå‚ä¼˜åŒ–è°ƒåº¦å»ºæ¨¡è¯´æ˜

## ğŸ“‹ ç›®å½•
- [1. å»ºæ¨¡æ¦‚è¿°](#1-å»ºæ¨¡æ¦‚è¿°)
- [2. å†³ç­–å˜é‡](#2-å†³ç­–å˜é‡)
- [3. ç›®æ ‡å‡½æ•°](#3-ç›®æ ‡å‡½æ•°)
- [4. çº¦æŸæ¡ä»¶](#4-çº¦æŸæ¡ä»¶)
- [5. æ¨¡å‹ç‰¹ç‚¹](#5-æ¨¡å‹ç‰¹ç‚¹)
- [6. æ±‚è§£æ–¹æ³•](#6-æ±‚è§£æ–¹æ³•)

---

## 1. å»ºæ¨¡æ¦‚è¿°

è™šæ‹Ÿç”µå‚ä¼˜åŒ–è°ƒåº¦é—®é¢˜æ˜¯ä¸€ä¸ªå¤šæ—¶æ®µã€å¤šèµ„æºçš„çº¿æ€§è§„åˆ’ä¼˜åŒ–é—®é¢˜ã€‚ç³»ç»Ÿç›®æ ‡æ˜¯åœ¨æ»¡è¶³ç”µåŠ›å¹³è¡¡å’Œè®¾å¤‡è¿è¡Œçº¦æŸçš„å‰æä¸‹ï¼Œæœ€å°åŒ–ç³»ç»Ÿæ€»è¿è¡Œæˆæœ¬ã€‚

### 1.1 æ—¶é—´åŸŸè®¾ç½®
- **ä¼˜åŒ–æ—¶é•¿**: T = 24å°æ—¶
- **æ—¶é—´æ­¥é•¿**: Î”t = 1å°æ—¶
- **æ—¶é—´é›†åˆ**: t âˆˆ {1, 2, ..., T}

### 1.2 èµ„æºç±»å‹
- **å¯å†ç”Ÿèƒ½æº**: å…‰ä¼å‘ç”µã€é£åŠ›å‘ç”µ
- **ä¼ ç»Ÿæœºç»„**: ç‡ƒæ°”è½®æœº
- **å‚¨èƒ½ç³»ç»Ÿ**: ç”µæ± å‚¨èƒ½
- **å¯è°ƒè´Ÿè·**: å†·æœºã€çƒ­æ³µ
- **ç”µç½‘äº¤äº’**: è´­ç”µã€å”®ç”µ

---

## 2. å†³ç­–å˜é‡

### 2.1 å‘ç”µå˜é‡
- $P_{pv}(t)$ : å…‰ä¼å‘ç”µåŠŸç‡ [MW]
- $P_{wind}(t)$ : é£åŠ›å‘ç”µåŠŸç‡ [MW]
- $P_{gas}(t)$ : ç‡ƒæ°”æœºç»„å‘ç”µåŠŸç‡ [MW]
- $u_{gas}(t)$ : ç‡ƒæ°”æœºç»„å¯åœçŠ¶æ€ {0,1}

### 2.2 å‚¨èƒ½å˜é‡
- $P_{bat}^{ch}(t)$ : å‚¨èƒ½å……ç”µåŠŸç‡ [MW]
- $P_{bat}^{dis}(t)$ : å‚¨èƒ½æ”¾ç”µåŠŸç‡ [MW]
- $SOC(t)$ : å‚¨èƒ½è·ç”µçŠ¶æ€ [%]
- $u_{ch}(t), u_{dis}(t)$ : å……æ”¾ç”µçŠ¶æ€å˜é‡ {0,1}

### 2.3 è¾…åŠ©æœåŠ¡å˜é‡
- $P_{reg}^{up}(t)$ : å‘ä¸Šè°ƒé¢‘é¢„ç•™å®¹é‡ [MW]
- $P_{reg}^{down}(t)$ : å‘ä¸‹è°ƒé¢‘é¢„ç•™å®¹é‡ [MW]
- $P_{spin}^{up}(t)$ : å‘ä¸Šå¤‡ç”¨å®¹é‡ [MW]
- $P_{spin}^{down}(t)$ : å‘ä¸‹å¤‡ç”¨å®¹é‡ [MW]
- $u_{reg}(t)$ : è°ƒé¢‘æœåŠ¡å‚ä¸çŠ¶æ€ {0,1}
- $u_{spin}(t)$ : å¤‡ç”¨æœåŠ¡å‚ä¸çŠ¶æ€ {0,1}

### 2.4 å¯è°ƒè´Ÿè·å˜é‡
- $P_{chill}(t)$ : å†·æœºåŠŸç‡ [MW]
- $P_{heat}(t)$ : çƒ­æ³µåŠŸç‡ [MW]

### 2.5 ç”µç½‘äº¤äº’å˜é‡
- $P_{buy}(t)$ : ä»ç”µç½‘è´­ç”µåŠŸç‡ [MW]
- $P_{sell}(t)$ : å‘ç”µç½‘å”®ç”µåŠŸç‡ [MW]

---

## 3. ç›®æ ‡å‡½æ•°

### 3.1 æ€»æˆæœ¬æœ€å°åŒ–ç›®æ ‡

$$
\min Z = \sum_{t=1}^{T} \left[ C_{gen}(t) + C_{bat}(t) + C_{load}(t) + C_{grid}(t) - R_{as}(t) \right]
$$

å…¶ä¸­ $R_{as}(t)$ ä¸ºè¾…åŠ©æœåŠ¡æ”¶å…¥ã€‚

### 3.2 æˆæœ¬ç»„æˆè¯¦è§£

#### 3.2.1 å‘ç”µæˆæœ¬
$$
C_{gen}(t) = c_{pv} \cdot P_{pv}(t) + c_{wind} \cdot P_{wind}(t) + c_{gas} \cdot P_{gas}(t) + S_{gas} \cdot u_{gas}(t)
$$

å…¶ä¸­ï¼š
- $c_{pv} = 5$ å…ƒ/MWh ï¼ˆå…‰ä¼è¿ç»´æˆæœ¬ï¼‰
- $c_{wind} = 8$ å…ƒ/MWh ï¼ˆé£ç”µè¿ç»´æˆæœ¬ï¼‰
- $c_{gas} = 600$ å…ƒ/MWh ï¼ˆç‡ƒæ°”å˜åŠ¨æˆæœ¬ï¼‰
- $S_{gas} = 10000$ å…ƒ ï¼ˆç‡ƒæ°”æœºç»„å¯åŠ¨æˆæœ¬ï¼‰

#### 3.2.2 å‚¨èƒ½æˆæœ¬
$$
C_{bat}(t) = c_{ch} \cdot P_{bat}^{ch}(t) + c_{dis} \cdot P_{bat}^{dis}(t)
$$

å…¶ä¸­ï¼š
- $c_{ch} = 10$ å…ƒ/MWh ï¼ˆå……ç”µæˆæœ¬ï¼‰
- $c_{dis} = 15$ å…ƒ/MWh ï¼ˆæ”¾ç”µæˆæœ¬ï¼‰

#### 3.2.3 å¯è°ƒè´Ÿè·æˆæœ¬
$$
C_{load}(t) = c_{chill} \cdot P_{chill}(t) + c_{heat} \cdot P_{heat}(t)
$$

å…¶ä¸­ï¼š
- $c_{chill} = 50$ å…ƒ/MWh ï¼ˆå†·æœºè¿è¡Œæˆæœ¬ï¼‰
- $c_{heat} = 40$ å…ƒ/MWh ï¼ˆçƒ­æ³µè¿è¡Œæˆæœ¬ï¼‰

#### 3.2.4 ç”µç½‘äº¤æ˜“æˆæœ¬
$$
C_{grid}(t) = c_{buy}(t) \cdot P_{buy}(t) - c_{sell}(t) \cdot P_{sell}(t)
$$

å…¶ä¸­ï¼š
- $c_{buy}(t)$ : åˆ†æ—¶è´­ç”µä»·æ ¼ [å…ƒ/MWh]
- $c_{sell}(t) = 0.95 \times c_{buy}(t)$ : å”®ç”µä»·æ ¼ [å…ƒ/MWh]

#### 3.2.5 è¾…åŠ©æœåŠ¡æ”¶å…¥
$$
R_{as}(t) = \lambda_{reg}^{up}(t) \cdot P_{reg}^{up}(t) + \lambda_{reg}^{down}(t) \cdot P_{reg}^{down}(t) + 
$$
$$
\lambda_{spin}^{up}(t) \cdot P_{spin}^{up}(t) + \lambda_{spin}^{down}(t) \cdot P_{spin}^{down}(t)
$$

å…¶ä¸­ï¼š
- $\lambda_{reg}^{up}(t) = 80$ å…ƒ/MW ï¼ˆå‘ä¸Šè°ƒé¢‘ä»·æ ¼ï¼‰
- $\lambda_{reg}^{down}(t) = 70$ å…ƒ/MW ï¼ˆå‘ä¸‹è°ƒé¢‘ä»·æ ¼ï¼‰
- $\lambda_{spin}^{up}(t) = 60$ å…ƒ/MW ï¼ˆå‘ä¸Šå¤‡ç”¨ä»·æ ¼ï¼‰
- $\lambda_{spin}^{down}(t) = 50$ å…ƒ/MW ï¼ˆå‘ä¸‹å¤‡ç”¨ä»·æ ¼ï¼‰

---

## 4. çº¦æŸæ¡ä»¶

### 4.1 ç”µåŠ›å¹³è¡¡çº¦æŸ

#### 4.1.1 åŠŸç‡å¹³è¡¡
$$
P_{pv}(t) + P_{wind}(t) + P_{gas}(t) + P_{bat}^{dis}(t) + P_{buy}(t) = 
$$
$$
D(t) + P_{chill}(t) + P_{heat}(t) + P_{bat}^{ch}(t) + P_{sell}(t) \quad \forall t
$$

å…¶ä¸­ $D(t)$ ä¸ºåŸºç¡€è´Ÿè·éœ€æ±‚ã€‚

### 4.2 è®¾å¤‡å®¹é‡çº¦æŸ

#### 4.2.1 å¯å†ç”Ÿèƒ½æºçº¦æŸ
$$
0 \leq P_{pv}(t) \leq P_{pv}^{max} \cdot CF_{pv}(t) \quad \forall t
$$
$$
0 \leq P_{wind}(t) \leq P_{wind}^{max} \cdot CF_{wind}(t) \quad \forall t
$$

å…¶ä¸­ï¼š
- $P_{pv}^{max} = 50$ MW, $P_{wind}^{max} = 30$ MW
- $CF_{pv}(t), CF_{wind}(t)$ ä¸ºå®¹é‡å› å­

#### 4.2.2 ç‡ƒæ°”æœºç»„çº¦æŸ
$$
P_{gas}^{min} \cdot u_{gas}(t) \leq P_{gas}(t) \leq P_{gas}^{max} \cdot u_{gas}(t) \quad \forall t
$$
$$
P_{gas}(t) - P_{gas}(t-1) \leq R_{up} \quad \forall t
$$
$$
P_{gas}(t-1) - P_{gas}(t) \leq R_{down} \quad \forall t
$$

å…¶ä¸­ï¼š
- $P_{gas}^{max} = 100$ MW, $P_{gas}^{min} = 30$ MW
- $R_{up} = R_{down} = 30$ MW/h ï¼ˆçˆ¬å¡é€Ÿç‡ï¼‰

### 4.3 å‚¨èƒ½ç³»ç»Ÿçº¦æŸ

#### 4.3.1 åŠŸç‡çº¦æŸ
$$
0 \leq P_{bat}^{ch}(t) \leq P_{bat}^{max} \cdot u_{ch}(t) \quad \forall t
$$
$$
0 \leq P_{bat}^{dis}(t) \leq P_{bat}^{max} \cdot u_{dis}(t) \quad \forall t
$$
$$
u_{ch}(t) + u_{dis}(t) \leq 1 \quad \forall t
$$

#### 4.3.2 SOCçº¦æŸ
$$
SOC(t) = SOC(t-1) + \frac{\eta_{ch} \cdot P_{bat}^{ch}(t) - \frac{P_{bat}^{dis}(t)}{\eta_{dis}}}{E_{bat}^{max}} \cdot \Delta t \quad \forall t
$$
$$
SOC_{min} \leq SOC(t) \leq SOC_{max} \quad \forall t
$$
$$
SOC(0) = SOC_{init} = 0.5
$$

å…¶ä¸­ï¼š
- $P_{bat}^{max} = 50$ MW, $E_{bat}^{max} = 200$ MWh
- $\eta_{ch} = \eta_{dis} = 0.95$
- $SOC_{min} = 0.2, SOC_{max} = 0.9$

### 4.4 è¾…åŠ©æœåŠ¡çº¦æŸ

#### 4.4.1 å®¹é‡é¢„ç•™çº¦æŸ
$$
P_{bat}^{ch}(t) + P_{reg}^{up}(t) + P_{spin}^{up}(t) \leq P_{bat}^{max} \quad \forall t
$$
$$
P_{bat}^{dis}(t) + P_{reg}^{down}(t) + P_{spin}^{down}(t) \leq P_{bat}^{max} \quad \forall t
$$

#### 4.4.2 SOCæ”¯æ’‘çº¦æŸ
$$
SOC(t) \geq SOC_{min} + \frac{P_{reg}^{down}(t) + P_{spin}^{down}(t)}{E_{bat}^{max}} \quad \forall t
$$
$$
SOC(t) \leq SOC_{max} - \frac{P_{reg}^{up}(t) + P_{spin}^{up}(t)}{E_{bat}^{max}} \quad \forall t
$$

#### 4.4.3 è°ƒé¢‘æœåŠ¡çº¦æŸ
$$
0 \leq P_{reg}^{up}(t) \leq P_{reg}^{max} \cdot u_{reg}(t) \quad \forall t
$$
$$
0 \leq P_{reg}^{down}(t) \leq P_{reg}^{max} \cdot u_{reg}(t) \quad \forall t
$$
$$
P_{reg}^{up}(t) + P_{reg}^{down}(t) \leq P_{reg}^{max} \quad \forall t
$$

#### 4.4.4 å¤‡ç”¨æœåŠ¡çº¦æŸ
$$
0 \leq P_{spin}^{up}(t) \leq P_{spin}^{max} \cdot u_{spin}(t) \quad \forall t
$$
$$
0 \leq P_{spin}^{down}(t) \leq P_{spin}^{max} \cdot u_{spin}(t) \quad \forall t
$$
$$
P_{spin}^{up}(t) + P_{spin}^{down}(t) \leq P_{spin}^{max} \quad \forall t
$$

å…¶ä¸­ï¼š$P_{reg}^{max} = 20$ MW, $P_{spin}^{max} = 15$ MW

#### 4.4.5 è¾…åŠ£æœåŠ¡äº’æ–¥çº¦æŸ
$$
u_{reg}(t) + u_{spin}(t) \leq 1 \quad \forall t
$$

### 4.5 å¯è°ƒè´Ÿè·çº¦æŸ

#### 4.5.1 å†·æœºçº¦æŸ
$$
P_{chill}^{min} \leq P_{chill}(t) \leq P_{chill}^{max} \quad \forall t
$$

å…¶ä¸­ï¼š$P_{chill}^{max} = 20$ MW, $P_{chill}^{min} = 6$ MW

#### 4.5.2 çƒ­æ³µçº¦æŸ
$$
P_{heat}^{min} \leq P_{heat}(t) \leq P_{heat}^{max} \quad \forall t
$$

å…¶ä¸­ï¼š$P_{heat}^{max} = 15$ MW, $P_{heat}^{min} = 3$ MW

### 4.6 ç”µç½‘äº¤äº’çº¦æŸ

$$
0 \leq P_{buy}(t) \leq P_{buy}^{max} \quad \forall t
$$
$$
0 \leq P_{sell}(t) \leq P_{sell}^{max} \quad \forall t
$$

å…¶ä¸­ï¼š$P_{buy}^{max} = 1000$ MW, $P_{sell}^{max} = 500$ MW

---

## 5. æ¨¡å‹ç‰¹ç‚¹

### 5.1 çº¿æ€§è§„åˆ’ç‰¹æ€§
- **å˜é‡ç±»å‹**: è¿ç»­å˜é‡ + äºŒè¿›åˆ¶å˜é‡
- **ç›®æ ‡å‡½æ•°**: çº¿æ€§
- **çº¦æŸæ¡ä»¶**: çº¿æ€§
- **æ¨¡å‹è§„æ¨¡**: å˜é‡æ•° â‰ˆ 200Ã—Tï¼Œçº¦æŸæ•° â‰ˆ 150Ã—T

### 5.2 æ—¶é—´è€¦åˆ
- **å‚¨èƒ½SOC**: æ—¶é—´çŠ¶æ€è€¦åˆ
- **æœºç»„å¯åœ**: å¯åŠ¨æˆæœ¬æ—¶é—´è€¦åˆ
- **çˆ¬å¡çº¦æŸ**: ç›¸é‚»æ—¶æ®µåŠŸç‡è€¦åˆ

### 5.3 ä¸ç¡®å®šæ€§å¤„ç†
- **ç¡®å®šæ€§ä¼˜åŒ–**: åŸºäºé¢„æµ‹æ•°æ®
- **é²æ£’æ€§**: é€šè¿‡å‚¨èƒ½å’Œå¯è°ƒè´Ÿè·æä¾›çµæ´»æ€§
- **æ»šåŠ¨ä¼˜åŒ–**: å®é™…åº”ç”¨ä¸­å¯é‡‡ç”¨æ»šåŠ¨æ—¶åŸŸä¼˜åŒ–

---

## 6. æ±‚è§£æ–¹æ³•

### 6.1 æ±‚è§£å™¨é…ç½®
- **ä¸»æ±‚è§£å™¨**: CBC (Coin-or Branch and Cut)
- **é—®é¢˜ç±»å‹**: MILP (Mixed Integer Linear Programming)
- **æ±‚è§£å‚æ•°**:
  - çº¿ç¨‹æ•°: 4
  - æ—¶é—´é™åˆ¶: 300ç§’
  - æœ€ä¼˜æ€§é—´éš™: 1%

### 6.2 æ±‚è§£ç­–ç•¥
```python
# CBCæ±‚è§£å™¨é…ç½®
solver_options = {
    'threads': 4,
    'timeLimit': 300,
    'ratioGap': 0.01,
    'logLevel': 1
}
```

### 6.3 é¢„å¤„ç†æŠ€æœ¯
- **é¢„æ±‚è§£**: ç®€åŒ–çº¦æŸå’Œå˜é‡
- **åˆ‡å‰²å¹³é¢**: æé«˜æ±‚è§£æ•ˆç‡
- **å¯å‘å¼ç®—æ³•**: å¿«é€Ÿè·å¾—åˆå§‹è§£

### 6.4 åå¤„ç†åˆ†æ
- **è§£çš„éªŒè¯**: æ£€æŸ¥çº¦æŸæ»¡è¶³æƒ…å†µ
- **æ•æ„Ÿæ€§åˆ†æ**: å…³é”®å‚æ•°å½±å“åˆ†æ
- **ç»æµæ€§è¯„ä¼°**: æˆæœ¬ç»“æ„åˆ†æ
- **æŠ€æœ¯æŒ‡æ ‡**: å¯å†ç”Ÿèƒ½æºåˆ©ç”¨ç‡ç­‰

---

## ğŸ“Š å…¸å‹æ±‚è§£ç»“æœ

### ä¼˜åŒ–æŒ‡æ ‡
- **æ±‚è§£æ—¶é—´**: 2-5ç§’
- **æœ€ä¼˜æ€§é—´éš™**: < 1%
- **å¯å†ç”Ÿèƒ½æºæ¸—é€ç‡**: 49.1%
- **æ€»è¿è¡Œæˆæœ¬**: 464,960å…ƒ/å¤©
- **å¯è°ƒè´Ÿè·å‚ä¸ç‡**: 16.4%
- **è¾…åŠ©æœåŠ¡æ”¶å…¥**: 38,400å…ƒ/å¤©
- **è°ƒé¢‘æœåŠ¡æä¾›å®¹é‡**: 15.2 MW
- **å¤‡ç”¨æœåŠ¡æä¾›å®¹é‡**: 12.8 MW

### å…³é”®æ´å¯Ÿ
1. **å‰Šå³°å¡«è°·**: å‚¨èƒ½ç³»ç»Ÿæœ‰æ•ˆå¹³æ»‘è´Ÿè·æ›²çº¿
2. **æˆæœ¬ä¼˜åŒ–**: å¯è°ƒè´Ÿè·å‚ä¸æ˜¾è‘—é™ä½ç³»ç»Ÿæˆæœ¬
3. **ç»¿è‰²è°ƒåº¦**: æœ€å¤§åŒ–å¯å†ç”Ÿèƒ½æºåˆ©ç”¨
4. **çµæ´»å“åº”**: å¤šå…ƒåŒ–èµ„æºæä¾›ç³»ç»Ÿè°ƒèŠ‚èƒ½åŠ›
5. **è¾…åŠ©æœåŠ¡ä»·å€¼**: å‚¨èƒ½å‚ä¸è¾…åŠ©æœåŠ¡å¸‚åœºæ˜¾è‘—æå‡ç»æµæ•ˆç›Š

---

*æœ¬æ–‡æ¡£åŸºäº oemof-solph å»ºæ¨¡æ¡†æ¶å’Œ CBC æ±‚è§£å™¨å®ç°çš„è™šæ‹Ÿç”µå‚ä¼˜åŒ–è°ƒåº¦ç³»ç»Ÿã€‚*