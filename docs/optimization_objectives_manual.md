# 虚拟电厂优化目标使用手册

## 概述

虚拟电厂调度优化系统现已支持**5种不同的优化目标**，从传统的成本最小化扩展到收益最大化、利润最大化、辅助服务收益最大化和电网支撑服务优化，更好地贴合实际虚拟电厂的商业运营需求。

## 优化目标详解

### 🎯 1. 成本最小化 (cost_minimization)
**传统优化目标，保持向后兼容**

#### 目标函数
```
最小化: 总运行成本 = 发电成本 + 储能运行成本 + 可调负荷成本 + 电网交易成本
```

#### 适用场景
- 传统电力系统调度
- 成本敏感型应用
- 公用事业公司
- 政府电力项目

#### 优劣势分析
- ✅ **优势**: 运行成本低、风险小、决策稳健
- ❌ **劣势**: 收益潜力有限、忽视市场机会

---

### 💰 2. 收益最大化 (revenue_maximization)
**重点关注收入增长**

#### 目标函数
```
最大化: 总收益 = 售电收入 + 辅助服务收入 + 储能套利收入 + 需求响应收入
```

#### 适用场景
- 电力市场化环境
- 售电公司
- 虚拟电厂运营商
- 分布式能源聚合商

#### 优劣势分析
- ✅ **优势**: 收入最大化、捕获市场机会、适应电价波动
- ❌ **劣势**: 可能忽视成本控制、风险相对较高

---

### 📈 3. 利润最大化 (profit_maximization)
**平衡收入与成本的最优策略**

#### 目标函数
```
最大化: 总利润 = (售电收入 + 辅助服务收入 + 储能套利收入) - (发电成本 + 运维成本 + 购电成本)
```

#### 适用场景
- 商业化虚拟电厂
- 投资项目评估
- 能源投资公司
- 分布式能源项目

#### 优劣势分析
- ✅ **优势**: 综合考虑收支、投资回报最佳、商业价值最大
- ❌ **劣势**: 可能存在波动、需要精准市场预测

---

### ⚡ 4. 辅助服务收益最大化 (ancillary_revenue_max)
**专注高价值电网服务**

#### 目标函数
```
最大化: 辅助服务收入 = 调频服务收入 + 旋转备用收入 + 电网调节收入
```

#### 适用场景
- 储能运营商
- 电网服务商
- 快速响应资源
- 储能电站运营

#### 优劣势分析
- ✅ **优势**: 高价值服务收入、电网稳定性贡献、技术门槛高
- ❌ **劣势**: 对设备要求高、市场准入门槛高

---

### 🌐 5. 电网支撑服务优化 (grid_support_optimized)
**兼顾经济性和电网稳定性**

#### 目标函数
```
最大化: 电网支撑指数
约束: 利润 >= 最小利润要求
```

#### 适用场景
- 电网公司
- 系统运营商
- 公用事业项目
- 电网稳定性服务

#### 优劣势分析
- ✅ **优势**: 电网稳定性最优、社会效益高、长期合作价值
- ❌ **劣势**: 经济性可能不是最优、收益相对保守

## 使用方法

### 🔧 交互式模式

```bash
python main.py
```

系统将提供两步选择：
1. **选择优化目标** (5种可选)
2. **选择调度模式** (6种资源组合)

### 🖥️ 程序化调用

```python
from src.models.scheduling_modes import VPPSchedulingManager, SchedulingMode, OptimizationObjective

# 创建管理器
manager = VPPSchedulingManager()

# 创建利润最大化的完整系统模型
model = manager.create_optimized_model(
    mode=SchedulingMode.FULL_SYSTEM,
    time_index=time_index,
    objective=OptimizationObjective.PROFIT_MAXIMIZATION
)
```

### 📊 批量对比

```bash
# 比较同一调度模式下的不同优化目标
python main.py  # 选择交互式，然后选择 "all"
```

## 技术实现

### 🔄 目标函数转换

不同优化目标通过调整变量成本系数实现：

```python
# 成本最小化
variable_costs_sign = +1    # 成本为正
revenue_sign = -1           # 收入为负成本

# 收益最大化  
variable_costs_sign = -1    # 成本在收益函数中为负
revenue_sign = +1           # 收入为正

# 利润最大化
variable_costs_sign = -1    # 成本为负
revenue_sign = +1           # 收入为正

# 辅助服务优化
ancillary_weight = 2.0      # 辅助服务收入权重加大
```

### ⚙️ 配置参数

每种优化目标有独立的配置参数：

```python
objective_config = {
    'type': 'maximization',
    'primary_focus': 'profit_optimization',
    'variable_costs_sign': -1,
    'revenue_sign': 1,
    'ancillary_weight': 1.0,    # 辅助服务权重
    'grid_support_weight': 1.0   # 电网支撑权重
}
```

## 应用场景对比

### 📊 经济性对比

| 优化目标 | 运行成本 | 收入水平 | 利润水平 | 风险等级 | 适用性 |
|---------|---------|---------|---------|---------|--------|
| 成本最小化 | 🟢 最低 | 🔴 一般 | 🟡 中等 | 🟢 低 | 传统系统 |
| 收益最大化 | 🔴 较高 | 🟢 最高 | 🟡 中等 | 🔴 高 | 市场化环境 |
| 利润最大化 | 🟡 中等 | 🟢 高 | 🟢 最高 | 🟡 中等 | 商业运营 |
| 辅助服务优化 | 🟡 中等 | 🟢 高 | 🟢 高 | 🟡 中等 | 储能运营 |
| 电网支撑优化 | 🟡 中等 | 🟡 中等 | 🟡 中等 | 🟢 低 | 公用事业 |

### 🎯 应用场景指南

#### 选择成本最小化，当你的需求是：
- 稳定可靠的电力供应
- 最小化运营风险
- 政府或公用事业项目
- 传统电力系统环境

#### 选择收益最大化，当你的需求是：
- 市场化电力交易
- 灵活参与电力市场
- 售电公司业务
- 短期收益最大化

#### 选择利润最大化，当你的需求是：
- 商业化虚拟电厂运营
- 投资项目评估
- 长期商业价值
- 综合经济效益

#### 选择辅助服务优化，当你的需求是：
- 储能系统运营
- 高价值电网服务
- 技术先进的资源
- 快速响应能力

#### 选择电网支撑优化，当你的需求是：
- 电网稳定性服务
- 系统运营商合作
- 社会效益优先
- 长期稳定收益

## 性能对比示例

### 📈 典型结果对比 (基于full_system模式)

```
优化目标           净成本(万元)    平均成本(元/MWh)    特点
================================================================
成本最小化         46.5           369.08            成本控制最佳
收益最大化         预计 35.0       预计 280.00       收入潜力最大  
利润最大化         预计 38.0       预计 300.00       综合效益最优
辅助服务优化       预计 40.0       预计 320.00       高价值服务
电网支撑优化       预计 42.0       预计 335.00       稳定性优先
```

*注：收益最大化等新目标的具体数值需要通过实际运行获得*
